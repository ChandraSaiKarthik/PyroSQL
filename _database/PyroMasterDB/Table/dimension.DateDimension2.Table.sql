SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dimension].[DateDimension2]') AND type in (N'U'))
BEGIN
CREATE TABLE [dimension].[DateDimension2](
	[CalendarDate] [date] NOT NULL,
	[CalendarDateValue]  AS (CONVERT([int],format([CalendarDate],'yyyyMMdd'))),
	[CalendarDateTime]  AS (CONVERT([datetime2](7),[CalendarDate])),
	[DayOfWeek]  AS (CONVERT([varchar](2),[dbo].[AdjustedDayOfWeek]([CalendarDate]))),
	[DayOfWeekValue]  AS (CONVERT([tinyint],[dbo].[AdjustedDayOfWeek]([CalendarDate]))),
	[DayOfWeekName]  AS (CONVERT([varchar](10),datename(weekday,[CalendarDate]))),
	[DayOfWeekAbbreviation]  AS (CONVERT([varchar](3),datename(weekday,[CalendarDate]))),
	[DayOfMonth]  AS (CONVERT([varchar](2),format(datepart(day,[CalendarDate]),'00'))),
	[DayOfMonthValue]  AS (CONVERT([tinyint],datepart(day,[CalendarDate]))),
	[DayOfQuarter]  AS (CONVERT([varchar](2),format(datediff(day,dateadd(quarter,datediff(quarter,(0),[CalendarDate]),(0)),[CalendarDate])+(1),'00'))),
	[DayOfQuarterValue]  AS (CONVERT([tinyint],datediff(day,dateadd(quarter,datediff(quarter,(0),[CalendarDate]),(0)),[CalendarDate])+(1))),
	[DayOfHalfYear]  AS (CONVERT([varchar](3),format(datediff(day,dateadd(month,((datepart(month,[CalendarDate])-(1))/(6))*(6),dateadd(year,datepart(year,[CalendarDate])-(1900),(0))),[CalendarDate]),'000'))),
	[DayOfHalfYearValue]  AS (CONVERT([tinyint],datediff(day,dateadd(quarter,datediff(quarter,(0),[CalendarDate]),(0)),[CalendarDate])+(1))),
	[DayOfYear]  AS (CONVERT([varchar](3),format(datediff(day,dateadd(year,datediff(year,(0),[CalendarDate]),(0)),[CalendarDate])+(1),'000'))),
	[DayOfYearValue]  AS (CONVERT([smallint],datediff(day,dateadd(year,datediff(year,(0),[CalendarDate]),(0)),[CalendarDate])+(1))),
	[DayOfYearCode]  AS (CONVERT([varchar](4),'D'+format(datediff(day,dateadd(year,datediff(year,(0),[CalendarDate]),(0)),[CalendarDate])+(1),'000'))),
	[WeekOfMonth]  AS (CONVERT([varchar](1),format(ceiling(((1.00)*(datediff(day,dateadd(day,((@@datefirst-datepart(weekday,dateadd(month,datepart(month,[CalendarDate])-(1),dateadd(year,datepart(year,[CalendarDate])-(1900),(0)))))+((8)-@@datefirst)*(2))%(7),dateadd(month,datepart(month,[CalendarDate])-(1),dateadd(year,datepart(year,[CalendarDate])-(1900),(0)))),[CalendarDate])+(1)))/(7))+case when datepart(day,dateadd(day,((@@datefirst-datepart(weekday,dateadd(month,datepart(month,[CalendarDate])-(1),dateadd(year,datepart(year,[CalendarDate])-(1900),(0)))))+((8)-@@datefirst)*(2))%(7),dateadd(month,datepart(month,[CalendarDate])-(1),dateadd(year,datepart(year,[CalendarDate])-(1900),(0)))))=(1) then (0) else (1) end,'0'))),
	[WeekOfMonthValue]  AS (CONVERT([tinyint],ceiling(((1.00)*(datediff(day,dateadd(day,((@@datefirst-datepart(weekday,dateadd(month,datepart(month,[CalendarDate])-(1),dateadd(year,datepart(year,[CalendarDate])-(1900),(0)))))+((8)-@@datefirst)*(2))%(7),dateadd(month,datepart(month,[CalendarDate])-(1),dateadd(year,datepart(year,[CalendarDate])-(1900),(0)))),[CalendarDate])+(1)))/(7))+case when datepart(day,dateadd(day,((@@datefirst-datepart(weekday,dateadd(month,datepart(month,[CalendarDate])-(1),dateadd(year,datepart(year,[CalendarDate])-(1900),(0)))))+((8)-@@datefirst)*(2))%(7),dateadd(month,datepart(month,[CalendarDate])-(1),dateadd(year,datepart(year,[CalendarDate])-(1900),(0)))))=(1) then (0) else (1) end)),
	[WeekOfQuarter]  AS (CONVERT([varchar](2),format(ceiling(((1.00)*(datediff(day,dateadd(day,((@@datefirst-datepart(weekday,dateadd(quarter,datepart(quarter,[CalendarDate])-(1),dateadd(year,datepart(year,[CalendarDate])-(1900),(0)))))+((8)-@@datefirst)*(2))%(7),dateadd(quarter,datepart(quarter,[CalendarDate])-(1),dateadd(year,datepart(year,[CalendarDate])-(1900),(0)))),[CalendarDate])+(1)))/(7))+case when datepart(day,dateadd(day,((@@datefirst-datepart(weekday,dateadd(quarter,datepart(quarter,[CalendarDate])-(1),dateadd(year,datepart(year,[CalendarDate])-(1900),(0)))))+((8)-@@datefirst)*(2))%(7),dateadd(quarter,datepart(quarter,[CalendarDate])-(1),dateadd(year,datepart(year,[CalendarDate])-(1900),(0)))))=(1) then (0) else (1) end,'0'))),
	[WeekOfQuarterValue]  AS (CONVERT([tinyint],ceiling(((1.00)*(datediff(day,dateadd(day,((@@datefirst-datepart(weekday,dateadd(quarter,datepart(quarter,[CalendarDate])-(1),dateadd(year,datepart(year,[CalendarDate])-(1900),(0)))))+((8)-@@datefirst)*(2))%(7),dateadd(quarter,datepart(quarter,[CalendarDate])-(1),dateadd(year,datepart(year,[CalendarDate])-(1900),(0)))),[CalendarDate])+(1)))/(7))+case when datepart(day,dateadd(day,((@@datefirst-datepart(weekday,dateadd(quarter,datepart(quarter,[CalendarDate])-(1),dateadd(year,datepart(year,[CalendarDate])-(1900),(0)))))+((8)-@@datefirst)*(2))%(7),dateadd(quarter,datepart(quarter,[CalendarDate])-(1),dateadd(year,datepart(year,[CalendarDate])-(1900),(0)))))=(1) then (0) else (1) end)),
	[WeekOfHalfYear]  AS (CONVERT([varchar](2),format(case when datepart(month,[CalendarDate])<=(6) then ceiling(((1.00)*(datediff(day,dateadd(day,((@@datefirst-datepart(weekday,dateadd(year,datepart(year,[CalendarDate])-(1900),(0))))+((8)-@@datefirst)*(2))%(7),dateadd(year,datepart(year,[CalendarDate])-(1900),(0))),[CalendarDate])+(1)))/(7))+case when datepart(day,dateadd(day,((@@datefirst-datepart(weekday,dateadd(year,datepart(year,[CalendarDate])-(1900),(0))))+((8)-@@datefirst)*(2))%(7),dateadd(year,datepart(year,[CalendarDate])-(1900),(0))))=(1) then (0) else (1) end else ceiling(((1.00)*(datediff(day,dateadd(day,((@@datefirst-datepart(weekday,dateadd(month,(6),dateadd(year,datepart(year,[CalendarDate])-(1900),(0)))))+((8)-@@datefirst)*(2))%(7),dateadd(month,(6),dateadd(year,datepart(year,[CalendarDate])-(1900),(0)))),[CalendarDate])+(1)))/(7))+case when datepart(day,dateadd(day,((@@datefirst-datepart(weekday,dateadd(year,datepart(year,[CalendarDate])-(1900),(0))))+((8)-@@datefirst)*(2))%(7),dateadd(month,(6),dateadd(year,datepart(year,[CalendarDate])-(1900),(0)))))=(1) then (0) else (1) end end,'00'))),
	[WeekOfHalfYearValue]  AS (CONVERT([tinyint],case when datepart(month,[CalendarDate])<=(6) then ceiling(((1.00)*(datediff(day,dateadd(day,((@@datefirst-datepart(weekday,dateadd(year,datepart(year,[CalendarDate])-(1900),(0))))+((8)-@@datefirst)*(2))%(7),dateadd(year,datepart(year,[CalendarDate])-(1900),(0))),[CalendarDate])+(1)))/(7))+case when datepart(day,dateadd(day,((@@datefirst-datepart(weekday,dateadd(year,datepart(year,[CalendarDate])-(1900),(0))))+((8)-@@datefirst)*(2))%(7),dateadd(year,datepart(year,[CalendarDate])-(1900),(0))))=(1) then (0) else (1) end else ceiling(((1.00)*(datediff(day,dateadd(day,((@@datefirst-datepart(weekday,dateadd(month,(6),dateadd(year,datepart(year,[CalendarDate])-(1900),(0)))))+((8)-@@datefirst)*(2))%(7),dateadd(month,(6),dateadd(year,datepart(year,[CalendarDate])-(1900),(0)))),[CalendarDate])+(1)))/(7))+case when datepart(day,dateadd(day,((@@datefirst-datepart(weekday,dateadd(year,datepart(year,[CalendarDate])-(1900),(0))))+((8)-@@datefirst)*(2))%(7),dateadd(month,(6),dateadd(year,datepart(year,[CalendarDate])-(1900),(0)))))=(1) then (0) else (1) end end)),
	[WeekOfYear]  AS (CONVERT([varchar](2),ceiling(((1.00)*(datediff(day,dateadd(day,((@@datefirst-datepart(weekday,dateadd(year,datepart(year,[CalendarDate])-(1900),(0))))+((8)-@@datefirst)*(2))%(7),dateadd(year,datepart(year,[CalendarDate])-(1900),(0))),[CalendarDate])+(1)))/(7))+case when datepart(day,dateadd(day,((@@datefirst-datepart(weekday,dateadd(year,datepart(year,[CalendarDate])-(1900),(0))))+((8)-@@datefirst)*(2))%(7),dateadd(year,datepart(year,[CalendarDate])-(1900),(0))))=(1) then (0) else (1) end)),
	[WeekOfYearValue]  AS (CONVERT([smallint],ceiling(((1.00)*(datediff(day,dateadd(day,((@@datefirst-datepart(weekday,dateadd(year,datepart(year,[CalendarDate])-(1900),(0))))+((8)-@@datefirst)*(2))%(7),dateadd(year,datepart(year,[CalendarDate])-(1900),(0))),[CalendarDate])+(1)))/(7))+case when datepart(day,dateadd(day,((@@datefirst-datepart(weekday,dateadd(year,datepart(year,[CalendarDate])-(1900),(0))))+((8)-@@datefirst)*(2))%(7),dateadd(year,datepart(year,[CalendarDate])-(1900),(0))))=(1) then (0) else (1) end)),
	[WeekOfYearCode]  AS (CONVERT([varchar](3),'W'+format(ceiling(((1.00)*(datediff(day,dateadd(day,((@@datefirst-datepart(weekday,dateadd(year,datepart(year,[CalendarDate])-(1900),(0))))+((8)-@@datefirst)*(2))%(7),dateadd(year,datepart(year,[CalendarDate])-(1900),(0))),[CalendarDate])+(1)))/(7))+case when datepart(day,dateadd(day,((@@datefirst-datepart(weekday,dateadd(year,datepart(year,[CalendarDate])-(1900),(0))))+((8)-@@datefirst)*(2))%(7),dateadd(year,datepart(year,[CalendarDate])-(1900),(0))))=(1) then (0) else (1) end,'00'))),
	[MonthOfQuarter]  AS (CONVERT([varchar](1),format(datediff(month,dateadd(quarter,datediff(quarter,(0),[CalendarDate]),(0)),[CalendarDate])+(1),'0'))),
	[MonthOfQuarterValue]  AS (CONVERT([tinyint],datediff(month,dateadd(quarter,datediff(quarter,(0),[CalendarDate]),(0)),[CalendarDate])+(1))),
	[MonthOfHalfYear]  AS (CONVERT([varchar](3),format(case when datepart(month,[CalendarDate])<=(6) then datepart(month,[CalendarDate]) else datediff(month,dateadd(month,(6),dateadd(year,datediff(year,(0),[CalendarDate]),(0))),[CalendarDate])+(1) end,'00'))),
	[MonthOfHalfYearValue]  AS (CONVERT([tinyint],case when datepart(month,[CalendarDate])<=(6) then datepart(month,[CalendarDate]) else datediff(month,dateadd(month,(6),dateadd(year,datediff(year,(0),[CalendarDate]),(0))),[CalendarDate])+(1) end)),
	[MonthOfYear]  AS (CONVERT([varchar](3),format(datepart(month,[CalendarDate]),'00'))),
	[MonthOfYearValue]  AS (CONVERT([smallint],datepart(month,[CalendarDate]))),
	[MonthOfYearCode]  AS (CONVERT([varchar](3),'M'+format(datepart(month,[CalendarDate]),'00'))),
	[QuarterOfHalfYear]  AS (CONVERT([varchar](1),format((2)-datepart(quarter,[CalendarDate])%(2),'0'))),
	[QuarterOfHalfYearValue]  AS (CONVERT([tinyint],(2)-datepart(quarter,[CalendarDate])%(2))),
	[QuarterOfYear]  AS (CONVERT([varchar](1),format(datepart(quarter,[CalendarDate]),'0'))),
	[QuarterOfYearValue]  AS (CONVERT([smallint],datepart(quarter,[CalendarDate]))),
	[QuarterOfYearCode]  AS (CONVERT([varchar](2),'Q'+format(datepart(quarter,[CalendarDate]),'0'))),
	[HalfYearOfYear]  AS (CONVERT([varchar](1),format(case when datepart(month,[CalendarDate])<=(6) then (1) else (2) end,'0'))),
	[HalfYearOfYearValue]  AS (CONVERT([smallint],case when datepart(month,[CalendarDate])<=(6) then (1) else (2) end)),
	[HalfYearOfYearCode]  AS (CONVERT([varchar](3),'H'+format(case when datepart(month,[CalendarDate])<=(6) then (1) else (2) end,'0'))),
	[WeekStartDate]  AS (CONVERT([date],dateadd(day, -(datepart(weekday,[CalendarDate])-(1)),[CalendarDate]))),
	[WeekEndDate]  AS (CONVERT([date],dateadd(day,(7)-datepart(weekday,[CalendarDate]),[CalendarDate]))),
	[MonthStartDate]  AS (CONVERT([date],dateadd(day,(1),eomonth([CalendarDate],(-1))))),
	[MonthEndDate]  AS (CONVERT([date],eomonth([CalendarDate]))),
	[QuarterStartDate]  AS (CONVERT([date],dateadd(quarter,datediff(quarter,(0),[CalendarDate]),(0)))),
	[QuarterEndDate]  AS (CONVERT([date],dateadd(day,(-1),dateadd(quarter,datediff(quarter,(0),[CalendarDate])+(1),(0))))),
	[HalfYearStartDate]  AS (CONVERT([date],dateadd(month,((datepart(month,[CalendarDate])-(1))/(6))*(6),dateadd(year,datepart(year,[CalendarDate])-(1900),(0))))),
	[HalfYearEndDate]  AS (CONVERT([date],dateadd(month,((datepart(month,[CalendarDate])-(1))/(6))*(6)+(6),dateadd(year,datepart(year,[CalendarDate])-(1900),(-1))))),
	[YearStartDate]  AS (CONVERT([date],dateadd(year,datediff(year,(0),[CalendarDate]),(0)))),
	[YearEndDate]  AS (CONVERT([date],dateadd(day,(-1),dateadd(year,datediff(year,(0),[CalendarDate])+(1),(0))))),
	[PreviousYear]  AS (CONVERT([smallint],datepart(year,[CalendarDate])-(1))),
	[NextYear]  AS (CONVERT([smallint],datepart(year,[CalendarDate])+(1))),
	[SameDayPreviousYear]  AS (CONVERT([date],dateadd(day,datepart(weekday,[CalendarDate]),dateadd(week,datepart(week,[CalendarDate])-(1),dateadd(day, -datepart(weekday,CONVERT([date],dateadd(year,datediff(year,(0),[CalendarDate])-(1),(0)))),CONVERT([date],dateadd(year,datediff(year,(0),[CalendarDate])-(1),(0)))))))),
	[SameDayNextYear]  AS (CONVERT([date],dateadd(day,datepart(weekday,[CalendarDate]),dateadd(week,datepart(week,[CalendarDate])-(1),dateadd(day, -datepart(weekday,CONVERT([date],dateadd(year,datediff(year,(0),[CalendarDate])+(1),(0)))),CONVERT([date],dateadd(year,datediff(year,(0),[CalendarDate])+(1),(0)))))))),
	[DayOfYearIndex]  AS (CONVERT([int],datediff(day,'2015-01-01',[CalendarDate]))),
	[WeekOfYearIndex]  AS (CONVERT([int],datediff(week,'2015-01-01',[CalendarDate]))),
	[MonthOfYearIndex]  AS (CONVERT([int],datediff(month,'2015-01-01',[CalendarDate]))),
	[QuarterOfYearIndex]  AS (CONVERT([int],datediff(quarter,'2015-01-01',[CalendarDate]))),
	[HalfYearOfYearIndex]  AS (CONVERT([int],datediff(quarter,'2015-01-01',[CalendarDate])/(2))),
	[YearIndex]  AS (CONVERT([int],datediff(year,'2015-01-01',[CalendarDate]))),
	[YearDayOfYear]  AS (CONVERT([varchar](7),CONVERT([nvarchar](4),datepart(year,[CalendarDate]))+format(datepart(day,[CalendarDate]),'000'))),
	[YearDayOfYearValue]  AS (CONVERT([int],CONVERT([nvarchar](4),datepart(year,[CalendarDate]))+format(datepart(day,[CalendarDate]),'000'))),
	[YearWeekOfYear]  AS (CONVERT([varchar](7),CONVERT([nvarchar](4),datepart(year,[CalendarDate]))+format(datepart(week,[CalendarDate]),'000'))),
	[YearWeekOfYearValue]  AS (CONVERT([int],CONVERT([nvarchar](4),datepart(year,[CalendarDate]))+format(datepart(week,[CalendarDate]),'000'))),
	[YearMonthOfYear]  AS (CONVERT([varchar](7),CONVERT([nvarchar](4),datepart(year,[CalendarDate]))+format(datepart(month,[CalendarDate]),'000'))),
	[YearMonthOfYearValue]  AS (CONVERT([int],CONVERT([nvarchar](4),datepart(year,[CalendarDate]))+format(datepart(month,[CalendarDate]),'000'))),
	[YearQuarterOfYear]  AS (CONVERT([varchar](7),CONVERT([nvarchar](4),datepart(year,[CalendarDate]))+format(datepart(quarter,[CalendarDate]),'000'))),
	[YearQuarterOfYearValue]  AS (CONVERT([int],CONVERT([nvarchar](4),datepart(year,[CalendarDate]))+format(datepart(quarter,[CalendarDate]),'000'))),
	[YearHalfYearOfYear]  AS (CONVERT([varchar](7),CONVERT([nvarchar](4),datepart(year,[CalendarDate]))+format(case when datepart(month,[CalendarDate])<=(6) then (1) else (2) end,'000'))),
	[YearHalfYearOfYearValue]  AS (CONVERT([int],CONVERT([nvarchar](4),datepart(year,[CalendarDate]))+format(case when datepart(month,[CalendarDate])<=(6) then (1) else (2) end,'000'))),
	[DayOfFinancialYear]  AS (CONVERT([nvarchar](3),datediff(day,case when datepart(month,[CalendarDate])>=(7) then CONVERT([date],concat_ws('-',datepart(year,[CalendarDate]),'07','01')) else dateadd(year,(-1),CONVERT([date],concat_ws('-',datepart(year,[CalendarDate]),'07','01'))) end,[CalendarDate])+(1))),
	[DayOfFinancialYearCode]  AS (CONVERT([nvarchar](5),'FD'+format(datediff(day,case when datepart(month,[CalendarDate])>=(7) then CONVERT([date],concat_ws('-',datepart(year,[CalendarDate]),'07','01')) else dateadd(year,(-1),CONVERT([date],concat_ws('-',datepart(year,[CalendarDate]),'07','01'))) end,[CalendarDate])+(1),'000'))),
	[WeekOfFinancialYear]  AS (CONVERT([varchar](2),format(case when datepart(month,[CalendarDate])>=(7) then ceiling(((1.00)*(datediff(day,dateadd(day,((@@datefirst-datepart(weekday,dateadd(month,(6),dateadd(year,datepart(year,[CalendarDate])-(1900),(0)))))+((8)-@@datefirst)*(2))%(7),dateadd(month,(6),dateadd(year,datepart(year,[CalendarDate])-(1900),(0)))),[CalendarDate])+(1)))/(7))+case when datepart(day,dateadd(day,((@@datefirst-datepart(weekday,dateadd(month,(6),dateadd(year,datepart(year,[CalendarDate])-(1900),(0)))))+((8)-@@datefirst)*(2))%(7),dateadd(month,(6),dateadd(year,datepart(year,[CalendarDate])-(1900),(0)))))=(1) then (0) else (1) end when datepart(month,[CalendarDate])<(7) then ceiling(((1.00)*(datediff(day,dateadd(day,((@@datefirst-datepart(weekday,dateadd(month,(6),dateadd(year,(datepart(year,[CalendarDate])-(1900))-(1),(0)))))+((8)-@@datefirst)*(2))%(7),dateadd(month,(6),dateadd(year,(datepart(year,[CalendarDate])-(1900))-(1),(0)))),[CalendarDate])+(1)))/(7))+case when datepart(day,dateadd(day,((@@datefirst-datepart(weekday,dateadd(month,(6),dateadd(year,(datepart(year,[CalendarDate])-(1900))-(1),(0)))))+((8)-@@datefirst)*(2))%(7),dateadd(month,(6),dateadd(year,(datepart(year,[CalendarDate])-(1900))-(1),(0)))))=(1) then (0) else (1) end else (0) end,'00'))),
	[WeekOfFinancialYearValue]  AS (CONVERT([tinyint],case when datepart(month,[CalendarDate])>=(7) then ceiling(((1.00)*(datediff(day,dateadd(day,((@@datefirst-datepart(weekday,dateadd(month,(6),dateadd(year,datepart(year,[CalendarDate])-(1900),(0)))))+((8)-@@datefirst)*(2))%(7),dateadd(month,(6),dateadd(year,datepart(year,[CalendarDate])-(1900),(0)))),[CalendarDate])+(1)))/(7))+case when datepart(day,dateadd(day,((@@datefirst-datepart(weekday,dateadd(month,(6),dateadd(year,datepart(year,[CalendarDate])-(1900),(0)))))+((8)-@@datefirst)*(2))%(7),dateadd(month,(6),dateadd(year,datepart(year,[CalendarDate])-(1900),(0)))))=(1) then (0) else (1) end when datepart(month,[CalendarDate])<(7) then ceiling(((1.00)*(datediff(day,dateadd(day,((@@datefirst-datepart(weekday,dateadd(month,(6),dateadd(year,(datepart(year,[CalendarDate])-(1900))-(1),(0)))))+((8)-@@datefirst)*(2))%(7),dateadd(month,(6),dateadd(year,(datepart(year,[CalendarDate])-(1900))-(1),(0)))),[CalendarDate])+(1)))/(7))+case when datepart(day,dateadd(day,((@@datefirst-datepart(weekday,dateadd(month,(6),dateadd(year,(datepart(year,[CalendarDate])-(1900))-(1),(0)))))+((8)-@@datefirst)*(2))%(7),dateadd(month,(6),dateadd(year,(datepart(year,[CalendarDate])-(1900))-(1),(0)))))=(1) then (0) else (1) end else (0) end)),
	[WeekOfFinancialYearCode]  AS (CONVERT([varchar](4),'FW'+format(case when datepart(month,[CalendarDate])>=(7) then ceiling(((1.00)*(datediff(day,dateadd(day,((@@datefirst-datepart(weekday,dateadd(month,(6),dateadd(year,datepart(year,[CalendarDate])-(1900),(0)))))+((8)-@@datefirst)*(2))%(7),dateadd(month,(6),dateadd(year,datepart(year,[CalendarDate])-(1900),(0)))),[CalendarDate])+(1)))/(7))+case when datepart(day,dateadd(day,((@@datefirst-datepart(weekday,dateadd(month,(6),dateadd(year,datepart(year,[CalendarDate])-(1900),(0)))))+((8)-@@datefirst)*(2))%(7),dateadd(month,(6),dateadd(year,datepart(year,[CalendarDate])-(1900),(0)))))=(1) then (0) else (1) end when datepart(month,[CalendarDate])<(7) then ceiling(((1.00)*(datediff(day,dateadd(day,((@@datefirst-datepart(weekday,dateadd(month,(6),dateadd(year,(datepart(year,[CalendarDate])-(1900))-(1),(0)))))+((8)-@@datefirst)*(2))%(7),dateadd(month,(6),dateadd(year,(datepart(year,[CalendarDate])-(1900))-(1),(0)))),[CalendarDate])+(1)))/(7))+case when datepart(day,dateadd(day,((@@datefirst-datepart(weekday,dateadd(month,(6),dateadd(year,(datepart(year,[CalendarDate])-(1900))-(1),(0)))))+((8)-@@datefirst)*(2))%(7),dateadd(month,(6),dateadd(year,(datepart(year,[CalendarDate])-(1900))-(1),(0)))))=(1) then (0) else (1) end else (0) end,'00'))),
	[MonthOfFinancialYear]  AS (CONVERT([nvarchar](2),format(case when datepart(month,[CalendarDate])>=(7) then (datepart(month,[CalendarDate])-(7))+(1) else (datepart(month,[CalendarDate])+(7))-(1) end,'00'))),
	[MonthOfFinancialYearValue]  AS (CONVERT([tinyint],format(case when datepart(month,[CalendarDate])>=(7) then (datepart(month,[CalendarDate])-(7))+(1) else (datepart(month,[CalendarDate])+(7))-(1) end,'00'))),
	[MonthOfFinancialYearCode]  AS (CONVERT([nvarchar](4),'FM'+format(case when datepart(month,[CalendarDate])>=(7) then (datepart(month,[CalendarDate])-(7))+(1) else (datepart(month,[CalendarDate])+(7))-(1) end,'00'))),
	[QuarterOfFinancialYear]  AS (CONVERT([nvarchar](2),format(case when datepart(month,[CalendarDate])>=(7) then datepart(quarter,[CalendarDate])-(2) else datepart(quarter,[CalendarDate])+(2) end,'0'))),
	[QuarterOfFinancialYearValue]  AS (CONVERT([tinyint],case when datepart(month,[CalendarDate])>=(7) then datepart(quarter,[CalendarDate])-(2) else datepart(quarter,[CalendarDate])+(2) end)),
	[QuarterOfFinancialYearCode]  AS (CONVERT([nvarchar](4),'FQ'+format(case when datepart(month,[CalendarDate])>=(7) then datepart(quarter,[CalendarDate])-(2) else datepart(quarter,[CalendarDate])+(2) end,'0'))),
	[HalfYearOfFinancialYear]  AS (CONVERT([nvarchar](2),format(case when datepart(month,[CalendarDate])>=(7) then (ceiling(datepart(quarter,[CalendarDate])/(2.00))-(2))+(1) else ceiling(datepart(quarter,[CalendarDate])/(2.00))+(1) end,'0'))),
	[HalfYearOfFinancialYearValue]  AS (CONVERT([tinyint],case when datepart(month,[CalendarDate])>=(7) then (ceiling(datepart(quarter,[CalendarDate])/(2.00))-(2))+(1) else ceiling(datepart(quarter,[CalendarDate])/(2.00))+(1) end)),
	[HalfYearOfFinancialYearCode]  AS (CONVERT([nvarchar](4),'HY'+format(case when datepart(month,[CalendarDate])>=(7) then (ceiling(datepart(quarter,[CalendarDate])/(2.00))-(2))+(1) else ceiling(datepart(quarter,[CalendarDate])/(2.00)) end+(1),'00'))),
	[FinancialYear]  AS (CONVERT([nvarchar](4),format(case when datepart(month,[CalendarDate])>=(7) then datepart(year,[CalendarDate])+(1) else datepart(year,[CalendarDate]) end,'0000'))),
	[FinancialYearValue]  AS (CONVERT([int],case when datepart(month,[CalendarDate])>=(7) then datepart(year,[CalendarDate])+(1) else datepart(year,[CalendarDate]) end)),
	[FinancialYearCode]  AS (CONVERT([nvarchar](6),'FY'+format(case when datepart(month,[CalendarDate])>=(7) then datepart(year,[CalendarDate])+(1) else datepart(year,[CalendarDate]) end,'0000'))),
	[NumberOfDaysInMonth]  AS (datediff(day,eomonth([CalendarDate],(-1)),CONVERT([date],eomonth([CalendarDate])))),
	[NumbersOfDaysInQuarter]  AS (datediff(day,dateadd(quarter,datediff(quarter,(0),[CalendarDate]),(0)),dateadd(day,(-1),dateadd(quarter,datediff(quarter,(0),[CalendarDate])+(1),(0))))),
	[NumbersOfDaysInHalfYear]  AS (datediff(day,dateadd(month,((datepart(month,[CalendarDate])-(1))/(6))*(6),dateadd(year,datepart(year,[CalendarDate])-(1900),(0))),dateadd(month,((datepart(month,[CalendarDate])-(1))/(6))*(6)+(6),dateadd(year,datepart(year,[CalendarDate])-(1900),(-1))))),
	[NumbersOfDaysInYear]  AS (datediff(day,dateadd(year,datediff(year,(0),[CalendarDate]),(0)),dateadd(day,(-1),dateadd(year,datediff(year,(0),[CalendarDate])+(1),(0))))),
	[IsToday]  AS (CONVERT([bit],case when CONVERT([date],dateadd(day,(0),getdate()))=[CalendarDate] then (1) else (0) end)),
	[IsPastDate]  AS (CONVERT([bit],case when CONVERT([date],dateadd(day,(0),getdate()))>[CalendarDate] then (1) else (0) end)),
	[IsFutureDate]  AS (CONVERT([bit],case when CONVERT([date],dateadd(day,(0),getdate()))<[CalendarDate] then (1) else (0) end)),
	[IsWeekDay]  AS (CONVERT([bit],case when datepart(weekday,[CalendarDate])=(6) then (0) when datepart(weekday,[CalendarDate])=(7) then (0) else (1) end)),
	[IsPublicHoliday]  AS (CONVERT([bit],(0))),
	[IsWorkDay]  AS (CONVERT([bit],(0))),
	[IsInLast7Days]  AS (CONVERT([bit],case when [CalendarDate]>=dateadd(day,(-7),CONVERT([date],dateadd(day,(0),getdate()))) AND [CalendarDate]<=dateadd(day,(-1),CONVERT([date],dateadd(day,(0),getdate()))) then (1) else (0) end)),
	[IsInLast7DaysIncludingToday]  AS (CONVERT([bit],case when [CalendarDate]>=dateadd(day,(-7),CONVERT([date],dateadd(day,(0),getdate()))) AND [CalendarDate]<=dateadd(day,(0),CONVERT([date],dateadd(day,(0),getdate()))) then (1) else (0) end)),
	[IsInLast30Days]  AS (CONVERT([bit],case when [CalendarDate]>=dateadd(day,(-30),CONVERT([date],dateadd(day,(0),getdate()))) AND [CalendarDate]<=dateadd(day,(-1),CONVERT([date],dateadd(day,(0),getdate()))) then (1) else (0) end)),
	[IsInLast30DaysIncludingToday]  AS (CONVERT([bit],case when [CalendarDate]>=dateadd(day,(-30),CONVERT([date],dateadd(day,(0),getdate()))) AND [CalendarDate]<=dateadd(day,(0),CONVERT([date],dateadd(day,(0),getdate()))) then (1) else (0) end)),
PRIMARY KEY CLUSTERED 
(
	[CalendarDate] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
) ON [PRIMARY]
END
GO
